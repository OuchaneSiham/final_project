generator client {
  provider = "prisma-client-js"
}
datasource db {
  provider = "postgresql"
}

model User {
  id               Int          @id @default(autoincrement())
  username         String       @unique
  email            String       @unique
  password         String?
  googleId         String?      @unique 
  avatar           String       @default("avatars/default.png")
  role             String       @default("user") 
  isOnline         Boolean      @default(false)   
  twoFactorEnabled Boolean      @default(false)  
  twoFactorSecret  String?  
  
  sentRequests     Friendship[] @relation("SentRequests")
  receivedRequests Friendship[] @relation("ReceivedRequests")

  @@map("user")
}

model Friendship {
  id          Int      @id @default(autoincrement())
  status      String   @default("pending")
  requester   User     @relation("SentRequests", fields: [requesterId], references: [id])
  requesterId Int
  addressee   User     @relation("ReceivedRequests", fields: [addresseeId], references: [id])
  addresseeId Int

  createdAt   DateTime @default(now())
  @@unique([requesterId, addresseeId])
}