{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ochangli/Desktop/tictactoe/frontend/src/app/chat/%5BconversationId%5D/page.jsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { use } from \"react\";\n\nconst USER_ID = 1;\n\nexport default function ChatPage({ params }) {\n  const { conversationId } = use(params);\n  const id = Number(conversationId);\n\n  const [messages, setMessages] = useState([]);\n  const [messageText, setMessageText] = useState(\"\");\n\n  useEffect(() => {\n    fetch(`http://localhost:3001/conversation/${id}/messages`)\n      .then((res) => res.json())\n      .then((data) => {\n        if (Array.isArray(data)) setMessages(data);\n      })\n      .catch(console.error);\n  }, [id]);\n\n  const handleSendMessage = async () => {\n    if (!messageText.trim()) return;\n\n    try {\n      const res = await fetch(\n        `http://localhost:3001/conversation/${id}/message`,\n        {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            userId: USER_ID,\n            content: messageText,\n          }),\n        }\n      );\n\n      if (!res.ok) return;\n\n      const newMessage = await res.json();\n      setMessages((prev) => [...prev, newMessage]);\n      setMessageText(\"\");\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  return (\n    <div style={{ padding: 20 }}>\n      <h2>Conversation {id}</h2>\n\n      <div style={{ marginBottom: 20 }}>\n        {messages.map((m) => {\n          const isMe = m.senderId === USER_ID;\n          const username = isMe\n            ? \"You\"\n            : m.sender?.username ?? `User ${m.senderId}`;\n\n          return (\n            <div\n              key={m.id}\n              style={{\n                maxWidth: 300,\n                padding: 8,\n                marginBottom: 6,\n                borderRadius: 6,\n                background: isMe ? \"#3b82f6\" : \"#e5e7eb\",\n                color: isMe ? \"white\" : \"black\",\n                marginLeft: isMe ? \"auto\" : \"0\",\n              }}\n            >\n              <div style={{ fontSize: 12, opacity: 0.7 }}>\n                {username}\n              </div>\n              <div>{m.content}</div>\n            </div>\n          );\n        })}\n      </div>\n\n      <input\n        type=\"text\"\n        value={messageText}\n        onChange={(e) => setMessageText(e.target.value)}\n        placeholder=\"Type a message...\"\n        style={{ padding: 8, width: \"80%\", marginRight: 10 }}\n      />\n      <button onClick={handleSendMessage} style={{ padding: 8 }}>\n        Send\n      </button>\n    </div>\n  );\n}\n\n\n\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;;AAKA,MAAM,UAAU;AAED,SAAS,SAAS,EAAE,MAAM,EAAE;;IACzC,MAAM,EAAE,cAAc,EAAE,GAAG,IAAA,gLAAG,EAAC;IAC/B,MAAM,KAAK,OAAO;IAElB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,qLAAQ,EAAC,EAAE;IAC3C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,qLAAQ,EAAC;IAE/C,IAAA,sLAAS;8BAAC;YACR,MAAM,CAAC,mCAAmC,EAAE,GAAG,SAAS,CAAC,EACtD,IAAI;sCAAC,CAAC,MAAQ,IAAI,IAAI;qCACtB,IAAI;sCAAC,CAAC;oBACL,IAAI,MAAM,OAAO,CAAC,OAAO,YAAY;gBACvC;qCACC,KAAK,CAAC,QAAQ,KAAK;QACxB;6BAAG;QAAC;KAAG;IAEP,MAAM,oBAAoB;QACxB,IAAI,CAAC,YAAY,IAAI,IAAI;QAEzB,IAAI;YACF,MAAM,MAAM,MAAM,MAChB,CAAC,mCAAmC,EAAE,GAAG,QAAQ,CAAC,EAClD;gBACE,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBACnB,QAAQ;oBACR,SAAS;gBACX;YACF;YAGF,IAAI,CAAC,IAAI,EAAE,EAAE;YAEb,MAAM,aAAa,MAAM,IAAI,IAAI;YACjC,YAAY,CAAC,OAAS;uBAAI;oBAAM;iBAAW;YAC3C,eAAe;QACjB,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC;QAChB;IACF;IAEA,qBACE,yMAAC;QAAI,OAAO;YAAE,SAAS;QAAG;;0BACxB,yMAAC;;oBAAG;oBAAc;;;;;;;0BAElB,yMAAC;gBAAI,OAAO;oBAAE,cAAc;gBAAG;0BAC5B,SAAS,GAAG,CAAC,CAAC;oBACb,MAAM,OAAO,EAAE,QAAQ,KAAK;oBAC5B,MAAM,WAAW,OACb,QACA,EAAE,MAAM,EAAE,YAAY,CAAC,KAAK,EAAE,EAAE,QAAQ,EAAE;oBAE9C,qBACE,yMAAC;wBAEC,OAAO;4BACL,UAAU;4BACV,SAAS;4BACT,cAAc;4BACd,cAAc;4BACd,YAAY,OAAO,YAAY;4BAC/B,OAAO,OAAO,UAAU;4BACxB,YAAY,OAAO,SAAS;wBAC9B;;0CAEA,yMAAC;gCAAI,OAAO;oCAAE,UAAU;oCAAI,SAAS;gCAAI;0CACtC;;;;;;0CAEH,yMAAC;0CAAK,EAAE,OAAO;;;;;;;uBAdV,EAAE,EAAE;;;;;gBAiBf;;;;;;0BAGF,yMAAC;gBACC,MAAK;gBACL,OAAO;gBACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;gBAC9C,aAAY;gBACZ,OAAO;oBAAE,SAAS;oBAAG,OAAO;oBAAO,aAAa;gBAAG;;;;;;0BAErD,yMAAC;gBAAO,SAAS;gBAAmB,OAAO;oBAAE,SAAS;gBAAE;0BAAG;;;;;;;;;;;;AAKjE;GAvFwB;KAAA"}}]
}